<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# server

```go
import "github.com/luisdavim/synthetic-checker/pkg/server"
```

## Index

- [Constants](<#constants>)
- [func Init(cmd *cobra.Command)](<#func-init>)
- [func LoadEnvConfig(rootDir string) error](<#func-loadenvconfig>)
- [func PrettyJSON(b []byte) []byte](<#func-prettyjson>)
- [func ReadConfig(config *Config) error](<#func-readconfig>)
- [type Auth](<#type-auth>)
- [type Config](<#type-config>)
- [type HTTP](<#type-http>)
- [type Handler](<#type-handler>)
- [type Routes](<#type-routes>)
- [type Server](<#type-server>)
  - [func New(cfg Config) *Server](<#func-new>)
  - [func NewWithRouter(cfg Config, r *mux.Router) *Server](<#func-newwithrouter>)
  - [func (s *Server) JSONResponse(w http.ResponseWriter, r *http.Request, result interface{}, responseCode int)](<#func-server-jsonresponse>)
  - [func (s *Server) Run()](<#func-server-run>)
  - [func (s *Server) Start(signals chan os.Signal) (srvs []*http.Server)](<#func-server-start>)
  - [func (s *Server) Use(mwf ...mux.MiddlewareFunc)](<#func-server-use>)
  - [func (s *Server) WithMethodNotAllowedHandler(notAllowed http.HandlerFunc)](<#func-server-withmethodnotallowedhandler>)
  - [func (s *Server) WithNotFoundHandler(notFound http.HandlerFunc)](<#func-server-withnotfoundhandler>)
  - [func (s *Server) WithPrefixedRoutes(prefix string, routes Routes)](<#func-server-withprefixedroutes>)
  - [func (s *Server) WithRoutes(routes Routes)](<#func-server-withroutes>)
  - [func (s *Server) WithShutdownFunc(shutdownFunc ShutdownFunc)](<#func-server-withshutdownfunc>)
- [type ShutdownFunc](<#type-shutdownfunc>)


## Constants

```go
const (
    HealthEndpoint  = "/healthz"
    MetricsEndpoint = "/metrics"
)
```

## func [Init](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/init.go#L19>)

```go
func Init(cmd *cobra.Command)
```

Init injects the server flags into a cobra command

## func [LoadEnvConfig](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/config.go#L63>)

```go
func LoadEnvConfig(rootDir string) error
```

## func [PrettyJSON](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/utils.go#L28>)

```go
func PrettyJSON(b []byte) []byte
```

## func [ReadConfig](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/config.go#L43>)

```go
func ReadConfig(config *Config) error
```

## type [Auth](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/config.go#L15-L18>)

Auth holds the BasicAuth credentials for the HTTP server

```go
type Auth struct {
    User string `mapstructure:"user,omitempty"`
    Pass string `mapstructure:"pass,omitempty"`
}
```

## type [Config](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/config.go#L33-L41>)

Config holds the full application configuration

```go
type Config struct {
    HTTP  HTTP `mapstructure:"http,omitempty"`
    Debug bool `mapstructure:"debug,omitempty"`
    // If you read the documentation for ScrictSlashes
    // it lets you know that it generates a 301 redirect and converts all requests to GET requests.
    // So a POST request to /route will turn into a GET to /route/ and that will cause problems.
    // So instead you can set StripSlashes that will strip the trailing slashes before routing.
    StripSlashes bool `mapstructure:"stripSlashes,omitempty"`
}
```

## type [HTTP](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/config.go#L21-L30>)

HTTP holds the configuration for the HTTP server

```go
type HTTP struct {
    Auth         Auth    `mapstructure:"auth,omitempty"`
    OperatorAuth string  `mapstructure:"operatorAuth,omitempty"`
    Port         int     `mapstructure:"port,omitempty"`
    SecurePort   int     `mapstructure:"securePort,omitempty"`
    CertFile     string  `mapstructure:"certFile,omitempty"`
    KeyFile      string  `mapstructure:"keyFile,omitempty"`
    RequestLimit float64 `mapstructure:"requestLimit,omitempty"`
    PrettyJSON   bool    `mapstructure:"prettyJSON,omitempty"`
}
```

## type [Handler](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L48-L62>)

```go
type Handler struct {
    // Methods adds a matcher for HTTP methods.
    // It accepts a sequence of one or more methods to be matched, e.g.:
    // "GET", "POST", "PUT".
    Methods []string
    // By default, if auth is enabled,
    // all endpoints, except the metrics and health,
    // will be secured
    NoAuth bool
    // By default all endpoints will be instrumented
    // and collect metrics regarding, duration, request count and status codes
    NoInstrumentation bool
    Name              string
    Func              http.HandlerFunc
}
```

## type [Routes](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L64>)

```go
type Routes map[string]Handler
```

## type [Server](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L40-L46>)

```go
type Server struct {
    // contains filtered or unexported fields
}
```

### func [New](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L67>)

```go
func New(cfg Config) *Server
```

New creates a new instance of the server.

### func [NewWithRouter](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L74>)

```go
func NewWithRouter(cfg Config, r *mux.Router) *Server
```

NewWithRouter creates a new instance of the server and allows you to pass a router

### func \(\*Server\) [JSONResponse](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/utils.go#L9>)

```go
func (s *Server) JSONResponse(w http.ResponseWriter, r *http.Request, result interface{}, responseCode int)
```

### func \(\*Server\) [Run](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L164>)

```go
func (s *Server) Run()
```

Run starts the server and waits for the signal to stop

### func \(\*Server\) [Start](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L185>)

```go
func (s *Server) Start(signals chan os.Signal) (srvs []*http.Server)
```

Start starts the server in the background.

### func \(\*Server\) [Use](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L159>)

```go
func (s *Server) Use(mwf ...mux.MiddlewareFunc)
```

Use appends a MiddlewareFunc to the chain. Middleware can be used to intercept or otherwise modify requests and/or responses, and are executed in the order that they are applied to the Router.

### func \(\*Server\) [WithMethodNotAllowedHandler](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L152>)

```go
func (s *Server) WithMethodNotAllowedHandler(notAllowed http.HandlerFunc)
```

WithMethodNotAllowedHandler allows you to specify a handler to use when a method is not allowed for the matched route

### func \(\*Server\) [WithNotFoundHandler](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L147>)

```go
func (s *Server) WithNotFoundHandler(notFound http.HandlerFunc)
```

WithNotFoundHandler allows you to specify a handler to use when no routes can be matched

### func \(\*Server\) [WithPrefixedRoutes](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L136>)

```go
func (s *Server) WithPrefixedRoutes(prefix string, routes Routes)
```

WithPrefixedRoutes adds routes to the server under the prefix using a subrouter

### func \(\*Server\) [WithRoutes](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L131>)

```go
func (s *Server) WithRoutes(routes Routes)
```

WithRoutes adds routes to the server, it may be called multiple times with different sets of routes.

### func \(\*Server\) [WithShutdownFunc](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L142>)

```go
func (s *Server) WithShutdownFunc(shutdownFunc ShutdownFunc)
```

WithShutdownFunc allows you to define the shutdown behavior. the ShutdownFunc will be called immediately before terminating the server

## type [ShutdownFunc](<https://github.com/luisdavim/synthetic-checker/blob/main/pkg/server/server.go#L38>)

```go
type ShutdownFunc func() error
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
